{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/metadata.ts","webpack:///./src/index.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","metadata","version","envMode","gitHash","lastCompiled","__webpack_exports__","src_BrowserStorage","BrowserStorage","areaName","options","this","storage","self","prefix","parse","text","JSON","stringify","available","x","setItem","ok","getItem","removeItem","e","DOMException","code","length","keys","_this","result","slice","Array","isArray","forEach","getBytesInUse","caches","push","xs","Blob","size","reduce","previousValue","currentValue","set","items","remove","clear"],"mappings":"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","file":"browser-storage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","interface ProjectMetadata {\r\n    name: string;\r\n    version: string;\r\n    envMode: \"none\" | \"development\" | \"production\";\r\n    gitHash: string;\r\n    lastCompiled: string;\r\n}\r\n\r\n// @ts-ignore (from webpack.DefinePlugin)\r\nexport const metadata: ProjectMetadata = __X_METADATA__;\r\n","import { metadata } from \"./metadata\";\r\n\r\ninterface BrowserStorageDefaultOptions {\r\n    prefix: string;\r\n    parse: (text: string) => any;\r\n    stringify: (value: any) => string;\r\n}\r\n\r\ninterface ArbitraryJsonObject {\r\n    [name: string]: any;\r\n}\r\n\r\nexport class BrowserStorage {\r\n    private readonly prefix: BrowserStorageDefaultOptions[\"prefix\"];\r\n    private readonly parse: BrowserStorageDefaultOptions[\"parse\"];\r\n    private readonly stringify: BrowserStorageDefaultOptions[\"stringify\"];\r\n\r\n    readonly storage: Storage;\r\n\r\n    static get metadata() {\r\n        return metadata;\r\n    }\r\n\r\n    constructor(\r\n        private readonly areaName: \"localStorage\" | \"sessionStorage\",\r\n        private readonly options: Partial<BrowserStorageDefaultOptions> = {}\r\n    ) {\r\n        this.storage = self[areaName];\r\n        this.prefix = this.options.prefix || \"\";\r\n        this.parse =\r\n            this.options.parse ||\r\n            function(text: string): any {\r\n                return JSON.parse(text);\r\n            };\r\n        this.stringify =\r\n            this.options.stringify ||\r\n            function(value: any): string {\r\n                return JSON.stringify(value);\r\n            };\r\n    }\r\n\r\n    /**\r\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\r\n     */\r\n    available(): boolean {\r\n        try {\r\n            const x = \"__storage_test__\";\r\n            this.storage.setItem(x, x);\r\n            const ok = this.storage.getItem(x) === x;\r\n            this.storage.removeItem(x);\r\n            return ok;\r\n        } catch (e) {\r\n            return (\r\n                e instanceof DOMException &&\r\n                // everything except Firefox\r\n                (e.code === 22 ||\r\n                    // Firefox\r\n                    e.code === 1014 ||\r\n                    // test name field too, because code might not be present\r\n                    // everything except Firefox\r\n                    e.name === \"QuotaExceededError\" ||\r\n                    // Firefox\r\n                    e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\r\n                // acknowledge QuotaExceededError only if there's something already stored\r\n                this.storage.length !== 0\r\n            );\r\n        }\r\n    }\r\n\r\n    get(keys: null | string | string[] | ArbitraryJsonObject): ArbitraryJsonObject {\r\n        const result = {};\r\n        if (keys === null) {\r\n            for (let i = 0; i < this.storage.length; i++) {\r\n                const key = this.storage.key(i);\r\n                if (key != null && key.slice(0, this.prefix.length) === this.prefix) {\r\n                    const value = this.storage.getItem(key);\r\n                    if (value != null) {\r\n                        result[key.slice(this.prefix.length)] = this.parse(value);\r\n                    }\r\n                }\r\n            }\r\n        } else if (typeof keys === \"string\" || Array.isArray(keys)) {\r\n            const xs = Array.isArray(keys) ? keys : [keys];\r\n            xs.forEach(x => {\r\n                const key = this.prefix + x;\r\n                const value = this.storage.getItem(key);\r\n                if (value != null) {\r\n                    result[x] = this.parse(value);\r\n                }\r\n            });\r\n        } else {\r\n            Object.keys(keys).forEach(x => {\r\n                const key = this.prefix + x;\r\n                const value = this.storage.getItem(key);\r\n                if (value != null) {\r\n                    result[x] = this.parse(value);\r\n                } else {\r\n                    if (keys.hasOwnProperty(x)) {\r\n                        result[x] = keys[x];\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @desc approximate value\r\n     */\r\n    getBytesInUse(keys: null | string | string[]): number {\r\n        const caches: string[] = [];\r\n        if (keys === null) {\r\n            for (let i = 0; i < this.storage.length; i++) {\r\n                const key = this.storage.key(i);\r\n                if (key != null && key.slice(0, this.prefix.length) === this.prefix) {\r\n                    const value = this.storage.getItem(key);\r\n                    if (value != null) {\r\n                        caches.push(key, value);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            const xs = Array.isArray(keys) ? keys : [keys];\r\n            for (let i = 0; i < xs.length; i++) {\r\n                const key = this.prefix + xs[i];\r\n                const value = this.storage.getItem(key);\r\n                if (value != null) {\r\n                    caches.push(key, value);\r\n                }\r\n            }\r\n        }\r\n        try {\r\n            return new Blob(caches).size;\r\n        } catch (e) {\r\n            return caches.reduce((previousValue, currentValue) => previousValue + currentValue.length, 0);\r\n        }\r\n    }\r\n\r\n    set(items: ArbitraryJsonObject): void {\r\n        Object.keys(items).forEach(x => {\r\n            const key = this.prefix + x;\r\n            this.storage.setItem(key, this.stringify(items[x]));\r\n        });\r\n    }\r\n\r\n    remove(keys: string | string[]): void {\r\n        const xs = Array.isArray(keys) ? keys : [keys];\r\n        xs.forEach(x => {\r\n            const key = this.prefix + x;\r\n            this.storage.removeItem(key);\r\n        });\r\n    }\r\n\r\n    clear(): void {\r\n        if (this.prefix) {\r\n            for (let i = 0; i < this.storage.length; i++) {\r\n                const key = this.storage.key(i);\r\n                if (key && key.slice(0, this.prefix.length) === this.prefix) {\r\n                    this.storage.removeItem(key);\r\n                }\r\n            }\r\n        } else {\r\n            this.storage.clear();\r\n        }\r\n    }\r\n}\r\n"],"sourceRoot":""}