{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/metadata.ts","webpack:///./src/index.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","metadata","freeze","version","revision","production","lastCompiled","__webpack_exports__","src_BrowserStorage","BrowserStorage","areaName","options","this","storage","self","prefix","parse","text","JSON","stringify","available","x","setItem","ok","getItem","removeItem","e","DOMException","code","length","keys","_this","result","slice","Array","isArray","forEach","getBytesInUse","caches","push","xs","Blob","size","reduce","previousValue","currentValue","set","items","remove","clear"],"mappings":";CAAA,SAAAA,EAAAC,GACA,oBAAAC,SAAA,iBAAAC,OACAA,OAAAD,QAAAD,SACA,sBAAAG,eAAAC,IACAD,OAAA,GAAAH,OACA,CACA,IAAAK,EAAAL,IACA,QAAAM,KAAAD,GAAA,iBAAAJ,gBAAAF,GAAAO,GAAAD,EAAAC,IAPA,CASCC,OAAA,WACD,mBCTA,IAAAC,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAT,QAGA,IAAAC,EAAAM,EAAAE,GAAA,CACAJ,EAAAI,EACAC,GAAA,EACAV,QAAA,IAUA,OANAW,EAAAF,GAAAG,KAAAX,EAAAD,QAAAC,IAAAD,QAAAQ,GAGAP,EAAAS,GAAA,EAGAT,EAAAD,QA0DA,OArDAQ,EAAAK,EAAAF,EAGAH,EAAAM,EAAAP,EAGAC,EAAAO,EAAA,SAAAf,EAAAgB,EAAAC,GACAT,EAAAU,EAAAlB,EAAAgB,IACAG,OAAAC,eAAApB,EAAAgB,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CT,EAAAe,EAAA,SAAAvB,GACA,oBAAAwB,eAAAC,aACAN,OAAAC,eAAApB,EAAAwB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAApB,EAAA,cAAiD0B,OAAA,KAQjDlB,EAAAmB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAlB,EAAAkB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFAvB,EAAAe,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAlB,EAAAO,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAtB,EAAA0B,EAAA,SAAAjC,GACA,IAAAgB,EAAAhB,KAAA4B,WACA,WAA2B,OAAA5B,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAO,EAAAO,EAAAE,EAAA,IAAAA,GACAA,GAIAT,EAAAU,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD5B,EAAA+B,EAAA,GAIA/B,IAAAgC,EAAA,yCCzEO,IAAMC,EAA4BtB,OAAOuB,OAAO,CAAA1B,KAAA,4BAAA2B,QAAA,QAAAC,SAAA,UAAAC,YAAA,EAAAC,aAAA,6BCTvDtC,EAAAO,EAAAgC,EAAA,mCAAAC,IAYA,IAAAA,EAAA,WAWI,SAAAC,EACqBC,EACAC,QAAA,IAAAA,MAAA,IADAC,KAAAF,WACAE,KAAAD,UAEjBC,KAAKC,QAAUC,KAAKJ,GACpBE,KAAKG,OAASH,KAAKD,QAAQI,QAAU,GACrCH,KAAKI,MACDJ,KAAKD,QAAQK,OACb,SAASC,GACL,OAAOC,KAAKF,MAAMC,IAE1BL,KAAKO,UACDP,KAAKD,QAAQQ,WACb,SAASjC,GACL,OAAOgC,KAAKC,UAAUjC,IAgItC,OAlJIP,OAAAC,eAAW6B,EAAA,WAAQ,KAAnB,WACI,OAAOR,mCAwBXQ,EAAAZ,UAAAuB,UAAA,WACI,IACI,IAAMC,EAAI,mBACVT,KAAKC,QAAQS,QAAQD,EAAGA,GACxB,IAAME,EAAKX,KAAKC,QAAQW,QAAQH,KAAOA,EAEvC,OADAT,KAAKC,QAAQY,WAAWJ,GACjBE,EACT,MAAOG,GACL,OACIA,aAAaC,eAED,KAAXD,EAAEE,MAEY,OAAXF,EAAEE,MAGS,uBAAXF,EAAElD,MAES,+BAAXkD,EAAElD,OAEkB,IAAxBoC,KAAKC,QAAQgB,SAKzBpB,EAAAZ,UAAAf,IAAA,SAAIgD,GAAJ,IAAAC,EAAAnB,KACUoB,EAAS,GACf,GAAa,OAATF,EACA,IAAK,IAAIjE,EAAI,EAAGA,EAAI+C,KAAKC,QAAQgB,OAAQhE,IAAK,CAC1C,IAAM2B,EAAMoB,KAAKC,QAAQrB,IAAI3B,GAC7B,GAAW,MAAP2B,GAAeA,EAAIyC,MAAM,EAAGrB,KAAKG,OAAOc,UAAYjB,KAAKG,OAAQ,CACjE,IAAM7B,EAAQ0B,KAAKC,QAAQW,QAAQhC,GACtB,MAATN,IACA8C,EAAOxC,EAAIyC,MAAMrB,KAAKG,OAAOc,SAAWjB,KAAKI,MAAM9B,UAI5D,GAAoB,iBAAT4C,GAAqBI,MAAMC,QAAQL,GAAO,EAC7CI,MAAMC,QAAQL,GAAQA,EAAO,CAACA,IACtCM,QAAQ,SAAAf,GACP,IAAM7B,EAAMuC,EAAKhB,OAASM,EACpBnC,EAAQ6C,EAAKlB,QAAQW,QAAQhC,GACtB,MAATN,IACA8C,EAAOX,GAAKU,EAAKf,MAAM9B,WAI/BP,OAAOmD,KAAKA,GAAMM,QAAQ,SAAAf,GACtB,IAAM7B,EAAMuC,EAAKhB,OAASM,EACpBnC,EAAQ6C,EAAKlB,QAAQW,QAAQhC,GACtB,MAATN,EACA8C,EAAOX,GAAKU,EAAKf,MAAM9B,GAEnB4C,EAAKhC,eAAeuB,KACpBW,EAAOX,GAAKS,EAAKT,MAKjC,OAAOW,GAMXvB,EAAAZ,UAAAwC,cAAA,SAAcP,GACV,IAAMQ,EAAmB,GACzB,GAAa,OAATR,EACA,IAAK,IAAIjE,EAAI,EAAGA,EAAI+C,KAAKC,QAAQgB,OAAQhE,IAAK,CAE1C,GAAW,OADL2B,EAAMoB,KAAKC,QAAQrB,IAAI3B,KACV2B,EAAIyC,MAAM,EAAGrB,KAAKG,OAAOc,UAAYjB,KAAKG,OAE5C,OADP7B,EAAQ0B,KAAKC,QAAQW,QAAQhC,KAE/B8C,EAAOC,KAAK/C,EAAKN,OAK7B,KAAMsD,EAAKN,MAAMC,QAAQL,GAAQA,EAAO,CAACA,GACzC,IAASjE,EAAI,EAAGA,EAAI2E,EAAGX,OAAQhE,IAAK,CAChC,IACMqB,EADAM,EAAMoB,KAAKG,OAASyB,EAAG3E,GAEhB,OADPqB,EAAQ0B,KAAKC,QAAQW,QAAQhC,KAE/B8C,EAAOC,KAAK/C,EAAKN,IAI7B,IACI,OAAO,IAAIuD,KAAKH,GAAQI,KAC1B,MAAOhB,GACL,OAAOY,EAAOK,OAAO,SAACC,EAAeC,GAAiB,OAAAD,EAAgBC,EAAahB,QAAQ,KAInGpB,EAAAZ,UAAAiD,IAAA,SAAIC,GAAJ,IAAAhB,EAAAnB,KACIjC,OAAOmD,KAAKiB,GAAOX,QAAQ,SAAAf,GACvB,IAAM7B,EAAMuC,EAAKhB,OAASM,EAC1BU,EAAKlB,QAAQS,QAAQ9B,EAAKuC,EAAKZ,UAAU4B,EAAM1B,QAIvDZ,EAAAZ,UAAAmD,OAAA,SAAOlB,GAAP,IAAAC,EAAAnB,MACesB,MAAMC,QAAQL,GAAQA,EAAO,CAACA,IACtCM,QAAQ,SAAAf,GACP,IAAM7B,EAAMuC,EAAKhB,OAASM,EAC1BU,EAAKlB,QAAQY,WAAWjC,MAIhCiB,EAAAZ,UAAAoD,MAAA,WACI,GAAIrC,KAAKG,OACL,IAAK,IAAIlD,EAAI,EAAGA,EAAI+C,KAAKC,QAAQgB,OAAQhE,IAAK,CAC1C,IAAM2B,EAAMoB,KAAKC,QAAQrB,IAAI3B,GACzB2B,GAAOA,EAAIyC,MAAM,EAAGrB,KAAKG,OAAOc,UAAYjB,KAAKG,QACjDH,KAAKC,QAAQY,WAAWjC,QAIhCoB,KAAKC,QAAQoC,SAGzBxC,EAzJA","file":"browser-storage.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","interface ProjectMetadata {\n    readonly name: string;\n    readonly version: string;\n    readonly revision: string;\n    readonly production: boolean;\n    readonly lastCompiled: string;\n}\n\n// @ts-ignore (from webpack.DefinePlugin)\nexport const metadata: ProjectMetadata = Object.freeze(__X_METADATA__);\n","import { metadata } from \"./metadata\";\n\ninterface BrowserStorageDefaultOptions {\n    prefix: string;\n    parse: (text: string) => any;\n    stringify: (value: any) => string;\n}\n\ninterface ArbitraryJsonObject {\n    [name: string]: any;\n}\n\nexport class BrowserStorage {\n    private readonly prefix: BrowserStorageDefaultOptions[\"prefix\"];\n    private readonly parse: BrowserStorageDefaultOptions[\"parse\"];\n    private readonly stringify: BrowserStorageDefaultOptions[\"stringify\"];\n\n    readonly storage: Storage;\n\n    static get metadata() {\n        return metadata;\n    }\n\n    constructor(\n        private readonly areaName: \"localStorage\" | \"sessionStorage\",\n        private readonly options: Partial<BrowserStorageDefaultOptions> = {},\n    ) {\n        this.storage = self[areaName];\n        this.prefix = this.options.prefix || \"\";\n        this.parse =\n            this.options.parse ||\n            function(text: string): any {\n                return JSON.parse(text);\n            };\n        this.stringify =\n            this.options.stringify ||\n            function(value: any): string {\n                return JSON.stringify(value);\n            };\n    }\n\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API\n     */\n    available(): boolean {\n        try {\n            const x = \"__storage_test__\";\n            this.storage.setItem(x, x);\n            const ok = this.storage.getItem(x) === x;\n            this.storage.removeItem(x);\n            return ok;\n        } catch (e) {\n            return (\n                e instanceof DOMException &&\n                // everything except Firefox\n                (e.code === 22 ||\n                    // Firefox\n                    e.code === 1014 ||\n                    // test name field too, because code might not be present\n                    // everything except Firefox\n                    e.name === \"QuotaExceededError\" ||\n                    // Firefox\n                    e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\n                // acknowledge QuotaExceededError only if there's something already stored\n                this.storage.length !== 0\n            );\n        }\n    }\n\n    get(keys: null | string | string[] | ArbitraryJsonObject): ArbitraryJsonObject {\n        const result = {};\n        if (keys === null) {\n            for (let i = 0; i < this.storage.length; i++) {\n                const key = this.storage.key(i);\n                if (key != null && key.slice(0, this.prefix.length) === this.prefix) {\n                    const value = this.storage.getItem(key);\n                    if (value != null) {\n                        result[key.slice(this.prefix.length)] = this.parse(value);\n                    }\n                }\n            }\n        } else if (typeof keys === \"string\" || Array.isArray(keys)) {\n            const xs = Array.isArray(keys) ? keys : [keys];\n            xs.forEach(x => {\n                const key = this.prefix + x;\n                const value = this.storage.getItem(key);\n                if (value != null) {\n                    result[x] = this.parse(value);\n                }\n            });\n        } else {\n            Object.keys(keys).forEach(x => {\n                const key = this.prefix + x;\n                const value = this.storage.getItem(key);\n                if (value != null) {\n                    result[x] = this.parse(value);\n                } else {\n                    if (keys.hasOwnProperty(x)) {\n                        result[x] = keys[x];\n                    }\n                }\n            });\n        }\n        return result;\n    }\n\n    /**\n     * @desc approximate value\n     */\n    getBytesInUse(keys: null | string | string[]): number {\n        const caches: string[] = [];\n        if (keys === null) {\n            for (let i = 0; i < this.storage.length; i++) {\n                const key = this.storage.key(i);\n                if (key != null && key.slice(0, this.prefix.length) === this.prefix) {\n                    const value = this.storage.getItem(key);\n                    if (value != null) {\n                        caches.push(key, value);\n                    }\n                }\n            }\n        } else {\n            const xs = Array.isArray(keys) ? keys : [keys];\n            for (let i = 0; i < xs.length; i++) {\n                const key = this.prefix + xs[i];\n                const value = this.storage.getItem(key);\n                if (value != null) {\n                    caches.push(key, value);\n                }\n            }\n        }\n        try {\n            return new Blob(caches).size;\n        } catch (e) {\n            return caches.reduce((previousValue, currentValue) => previousValue + currentValue.length, 0);\n        }\n    }\n\n    set(items: ArbitraryJsonObject): void {\n        Object.keys(items).forEach(x => {\n            const key = this.prefix + x;\n            this.storage.setItem(key, this.stringify(items[x]));\n        });\n    }\n\n    remove(keys: string | string[]): void {\n        const xs = Array.isArray(keys) ? keys : [keys];\n        xs.forEach(x => {\n            const key = this.prefix + x;\n            this.storage.removeItem(key);\n        });\n    }\n\n    clear(): void {\n        if (this.prefix) {\n            for (let i = 0; i < this.storage.length; i++) {\n                const key = this.storage.key(i);\n                if (key && key.slice(0, this.prefix.length) === this.prefix) {\n                    this.storage.removeItem(key);\n                }\n            }\n        } else {\n            this.storage.clear();\n        }\n    }\n}\n"],"sourceRoot":""}